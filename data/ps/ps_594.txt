Read problem statements in Hindi, Bengali, Mandarin Chinese, Russian, and Vietnamese as well.
Chef Ada has a matrix with NN rows (numbered 11 through NN from top to bottom) and NN columns (numbered 11 through NN from left to right) containing all integers between 11 and N2N2 inclusive. For each valid ii and jj, let's denote the cell in the ii-th row and jj-th column by (i,j)(i,j).
Ada wants to sort the matrix in row-major order ― for each valid ii and jj, she wants the cell (i,j)(i,j) to contain the value (i−1)⋅N+j(i−1)⋅N+j.
In one operation, Ada should choose an integer LL and transpose the submatrix between rows 11 and LL and columns 11 and LL (inclusive). Formally, for each ii and jj (1≤i,j≤L1≤i,j≤L), the value in the cell (i,j)(i,j) after this operation is equal to the value in (j,i)(j,i) before it.
The initial state of the matrix is chosen in such a way that it is possible to sort it using a finite number of operations (possibly zero). Find the smallest number of operations required to sort the matrix.
Input

The first line of the input contains a single integer TT denoting the number of test cases. The description of TT test cases follows.
The first line of each test case contains a single integer NN.
The next NN lines describe the matrix. For each valid ii, the ii-th of these lines contains NN space-separated integers ― the initial values in cells (i,1),(i,2),…,(i,N)(i,1),(i,2),…,(i,N).

Output
For each test case, print a single line containing one integer ― the smallest number of operations required to sort the matrix.
Constraints

4≤N≤644≤N≤64
the sum of N2N2 over all test files does not exceed 3⋅1053⋅105

Subtasks
Subtask #1 (10 points):

T≤50T≤50
N=4N=4

Subtask #2 (90 points): original constraints

                        Sample Input 1
                        





1
4
1 2 9 13
5 6 10 14
3 7 11 15
4 8 12 16



                        Sample Output 1
                        





2


Explanation
Example case 1: After the first operation, with L=2L=2, the resulting matrix is
1 5 9 13
2 6 10 14
3 7 11 15
4 8 12 16

After the second operation, with L=4L=4, the matrix becomes sorted
1 2 3 4
5 6 7 8
9 10 11 12
13 14 15 16




Author:
7★alei


Editorial:
https://discuss.codechef.com/problems/ADAMAT


Tags:

               
                 Matrices, ad-hoc
                 
                     
                     Mathematics, Algorithms, Constructive
                 
               
             
             



                        Difficulty Rating:
                    

1437


Date Added:
27-08-2020


Time Limit:
1 secs


Source Limit:
50000 Bytes


Languages:
CPP17, PYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, R, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, PRLG, SQLQ, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM





Submit

